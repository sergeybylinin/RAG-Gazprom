### RAG. Нейро-сотрудник. Консультант по отчетности ПАО 'Газпром'

#### Цель проекта:
Разработка нейронного сотрудника (RAG-системы) для автоматизации консультирования по отчетности ПАО "Газпром". Проект направлен на создание инструмента, который помогает анализировать финансовую отчетность компании, отвечать на вопросы пользователей и предоставлять точные данные из документов.

---

#### Что было сделано:
1. **Установка и настройка библиотек:**
   - Установлены необходимые библиотеки для работы с моделями машинного обучения, включая `transformers`, `llama_index`, `langchain`, `pyvis`, `phoenix` и другие.
   - Настроена среда для работы с Hugging Face моделями и инструментами для обработки текста.

2. **Загрузка и настройка модели:**
   - Использована модель `saiga_mistral_7b` с применением метода PEFT (LoRA) для эффективного использования ресурсов.
   - Настроены параметры квантования (`BitsAndBytesConfig`) для работы модели в ограниченных вычислительных ресурсах (например, в Google Colab).
   - Модель интегрирована в фреймворк `LlamaIndex` для работы с RAG (Retrieval-Augmented Generation).

3. **Создание базы знаний:**
   - Загружены документы с отчетностью ПАО "Газпром" за 2023 год.
   - Использована модель для создания векторных представлений текста (`sentence-transformers/LaBSE`).
   - Настроен пайплайн для автоматического объединения иерархических узлов документов (`AutoMergingRetrieverPack`).

4. **Трассировка и мониторинг:**
   - Настроена трассировка с использованием инструмента `Phoenix` для отслеживания работы модели и анализа результатов.
   - Реализована возможность визуализации и анализа трассировки через веб-интерфейс.

5. **Тестирование и демонстрация:**
   - Протестирована система на запросах, связанных с отчетностью компании (например, "Какова структура затрат компании?").
   - Реализован интерактивный интерфейс для взаимодействия с моделью.

---

#### Для чего это нужно:
- **Автоматизация анализа отчетности:** Система позволяет быстро находить и анализировать данные из финансовых отчетов, что экономит время сотрудников.
- **Консультирование пользователей:** Нейронный сотрудник предоставляет точные ответы на вопросы, связанные с отчетностью, что полезно для аналитиков, инвесторов и других заинтересованных лиц.
- **Улучшение прозрачности данных:** Пользователи могут легко получать доступ к структурированной информации из отчетов.

---

#### Трудности и боли, которые были решены:
1. **Обработка больших объемов данных:**
   - Отчеты ПАО "Газпром" содержат большое количество текстовой информации, что требует эффективной обработки.
   - Решение: Использование RAG-подхода, который сочетает поиск по базе знаний и генерацию ответов.

2. **Ограниченные вычислительные ресурсы:**
   - Работа с большими моделями (например, `saiga_mistral_7b`) требует значительных ресурсов.
   - Решение: Применение квантования (`BitsAndBytesConfig`) и методов PEFT (LoRA) для оптимизации использования памяти.

3. **Точность и релевантность ответов:**
   - Необходимо было обеспечить высокую точность ответов, чтобы избежать ошибок и недостоверной информации.
   - Решение: Использование модели `sentence-transformers/LaBSE` для создания точных векторных представлений текста и настройка пайплайна для автоматического объединения узлов.

4. **Интерпретируемость результатов:**
   - Пользователям важно понимать, на основе каких данных модель делает выводы.
   - Решение: Интеграция инструмента `Phoenix` для трассировки и визуализации процесса работы модели.

5. **Интеграция с документами:**
   - Необходимо было обеспечить возможность работы с различными форматами документов (PDF, текстовые файлы).
   - Решение: Использование библиотеки `SimpleDirectoryReader` для загрузки и обработки документов.

---

#### Итог:
Проект успешно решает задачу автоматизации анализа и консультирования по отчетности ПАО "Газпром". Нейронный сотрудник предоставляет точные и релевантные ответы на вопросы, связанные с финансовыми данными компании. Система может быть использована для улучшения процессов анализа данных и повышения эффективности работы с отчетностью.

---

### Пример использования:
1. Пользователь задает вопрос: "Какова структура затрат компании?"
2. Система анализирует документы с отчетностью и предоставляет ответ на основе данных.
3. Результат: "Структура затрат компании включает следующие категории: [список категорий и их доля в общих затратах]."

---

### Возможные улучшения:
1. **Расширение базы знаний:** Добавление данных за другие годы и из других источников.
2. **Улучшение модели:** Использование более мощных моделей или ансамблей моделей для повышения точности.
3. **Интеграция с API:** Подключение к внутренним системам компании для автоматического обновления данных.
4. **Мобильная версия:** Создание мобильного приложения для удобного доступа к системе.
